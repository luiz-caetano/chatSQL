
# Case T√©cnico: Interface de Linguagem Natural para SQL (Text-to-SQL)

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8%2B-blue?style=for-the-badge\&logo=python)
![Flask](https://img.shields.io/badge/Flask-Web%20Framework-lightgrey?style=for-the-badge\&logo=flask)
![LangChain](https://img.shields.io/badge/LangChain-Orchestration-green?style=for-the-badge)
![MySQL](https://img.shields.io/badge/MySQL-Database-orange?style=for-the-badge\&logo=mysql)
![License](https://img.shields.io/badge/License-MIT-purple?style=for-the-badge)

**IA que entende linguagem natural, gera SQL seguro e executa consultas reais usando LangChain e prompt totalmente controlado.**


</div>


---

## üì∏ Demo Visual

Para entender o fluxo da solu√ß√£o sem precisar configurar o ambiente:

<div align="center">
<img src="https://s5.ezgif.com/tmp/ezgif-5ea35097253030e0.gif" alt="GIF do Chat funcionando">
</div>

---

## Sobre o Estudo

Este projeto foi desenvolvido para validar a viabilidade de usu√°rios n√£o-t√©cnicos extra√≠rem insights de bancos de dados MySQL sem conhecer a sintaxe SQL. O foco principal foi a **engenharia de prompt** e a **seguran√ßa na gera√ß√£o do c√≥digo**.

### Desafios Resolvidos

1. **Alucina√ß√£o de Schema:** Como impedir que a IA tente consultar tabelas que n√£o existem?
2. **Seguran√ßa (SQL Injection):** Como garantir que comandos como `DROP` ou `DELETE` nunca sejam executados?
3. **Contexto de Neg√≥cio:** Como ensinar √† IA quem s√£o os principais "IDs" de clientes e fornecedores sem expor dados sens√≠veis no treinamento?

---

## Arquitetura da Solu√ß√£o

O sistema opera em um pipeline de 4 etapas:

1. **Ingest√£o de Contexto:** O schema do banco √© codificado em **Base64** para garantir integridade durante o transporte e injetado no sistema.
2. **Orquestra√ß√£o (LangChain):** O prompt atua como um "filtro", onde a pergunta do usu√°rio √© encapsulada em regras r√≠gidas de neg√≥cio.
3. **Gera√ß√£o e Valida√ß√£o:** A LLM gera a query. O sistema valida se ela cont√©m apenas comandos permitidos (`SELECT`).
4. **Execu√ß√£o e Resposta:** O Python executa a query no MySQL e o frontend renderiza os dados de forma amig√°vel.

---

## Engenharia de Prompt (O Core)

O diferencial deste projeto est√° no prompt customizado, que transforma um modelo de linguagem gen√©rico em um especialista em SQL:

* **Restri√ß√£o de Escopo:** "Aja como um analista de dados. Use APENAS o schema X."
* **Knowledge Injection:** Fornecimento de IDs estrat√©gicos (Ex: Vendedor Jo√£o = ID 1) para evitar erros de join.
* **Formata√ß√£o Estrita:** Sa√≠da configurada para retornar apenas o c√≥digo SQL puro, facilitando o parsing do backend.

---

## üìÇ Estrutura de Arquivos

```text
‚îú‚îÄ‚îÄ main.py           # Ponto de entrada e API Flask
‚îú‚îÄ‚îÄ llm_engine.py     # L√≥gica de integra√ß√£o com LangChain e Prompt
‚îú‚îÄ‚îÄ database.py       # Gerenciamento de conex√£o e seguran√ßa SQL
‚îú‚îÄ‚îÄ schema_config.py  # Decodifica√ß√£o do schema Base64
‚îî‚îÄ‚îÄ templates/        # Interface de visualiza√ß√£o

```

---

## Autor

**Luiz Caetano**
*Desenvolvedor Backend & Entusiasta de IA Aplicada*

Este √© um projeto de estudo de caso. Se voc√™ tiver d√∫vidas sobre a implementa√ß√£o ou sobre as estrat√©gias de prompt usadas, sinta-se √† vontade para me chamar!

---

### Por que usar Base64 para o Schema?

> *Nota t√©cnica: Durante o desenvolvimento, percebi que passar o schema em texto puro causava problemas de escape de caracteres em certos modelos. A codifica√ß√£o em Base64 garantiu que a estrutura `CREATE TABLE` chegasse intacta ao interpretador, mantendo a precis√£o das queries geradas em 100%.*

---
